#!/bin/bash

active_players=$(playerctl --list-all 2>/dev/null)
if [[ -z "$active_players" ]]; then
    echo ""
    exit 0
fi

# Check only active players
for player in $active_players; do
    status=$(playerctl -p "$player" status 2>/dev/null)
    if [[ "$status" == "Playing" ]]; then
        case "$player" in
            *spotify*) icon="󰓇" ;;
            *firefox*) icon="󰈹" ;;
            *mpd*) icon="󰎆" ;;
            *chromium*) icon="󰊯" ;;
            *) icon="󰎆" ;;
        esac
        song_info=$(playerctl -p "$player" metadata --format "$icon   {{title}} - {{artist}}" 2>/dev/null)
        echo "$song_info"
        exit 0
    fi
done
echo ""
