#!/bin/bash

# Check connection state
state=$(nmcli -t -f STATE general status)

case "$state" in
    "disconnected")
        printf "󰤮"
        ;;
    "connecting")
        printf "󱍸"
        ;;
    "connected (local only)"|"connected (site only)"|"connected")
        # Check if it's WiFi and get signal strength
        wifi_info=$(nmcli -t -f IN-USE,SIGNAL dev wifi | grep '^\*')

        if [[ -n "$wifi_info" ]]; then
            # Extract signal strength
            strength=$(echo "$wifi_info" | cut -d: -f2)

            if [[ "$strength" =~ ^[0-9]+$ ]]; then
                if [[ "$strength" -le 25 ]]; then
                    printf "󰤟"
                elif [[ "$strength" -le 50 ]]; then
                    printf "󰤢"
                elif [[ "$strength" -le 75 ]]; then
                    printf "󰤥"
                else
                    printf "󰤨"
                fi
            else
                printf "󰈀"  # Unknown strength
            fi
        else
            printf "󰈀"  # Not WiFi or no signal info
        fi
        ;;
    *)
        printf "󰤮"  # Unknown state, assume disconnected
        ;;
esac
